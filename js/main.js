var Main,main;Main=function(){t.prototype.palette=Palettes.PEPTO;t.prototype.options=[];t.prototype.lumaDiffThreshold=1;t.prototype.ditherType="noDither";t.prototype.excludeNative=false;function t(){this.canvas=document.getElementById("canvas");this.context=this.canvas.getContext("2d");this.excludeCheckbox=document.getElementById("exclude");this.excludeCheckbox.onchange=function(t){return function(e){t.excludeNative=e.target.checked;return t.filter(t.options)}}(this);this.sortSelect=document.getElementById("sort");this.sortSelect.onchange=function(t){return function(e){t.options=e.target.options[e.target.selectedIndex].value.split(",");return t.filter(t.options)}}(this);this.ditherSelect=document.getElementById("dither");this.ditherSelect.onchange=function(t){return function(e){t.ditherType=e.target.options[e.target.selectedIndex].value;return t.filter(t.options)}}(this);this.paletteSelect=document.getElementById("palette");this.paletteSelect.onchange=function(t){return function(e){var i;i=e.target.options[e.target.selectedIndex].value;t.palette=Palettes[i];return t.filter(t.options)}}(this);this.text=document.getElementById("text");this.slider=document.getElementById("slider");this.slider.oninput=function(t){return function(e){return t.text.value=e.target.value}}(this);this.slider.onchange=function(t){return function(e){t.lumaDiffThreshold=e.target.value;return t.filter(t.options)}}(this);this.filter();return}t.prototype.createData=function(){var t,e,i,o,l,s,n,r,a,c,h,d,u;this.mixed=[];this.json=[];for(n=a=0;a<=15;n=++a){for(r=c=u=n;u<=15?c<=15:c>=15;r=u<=15?++c:--c){t=ColorUtils.colorToHEX(this.palette[n]);i=ColorUtils.colorToHEX(this.palette[r]);h=ColorUtils.mixHEX(t,i);d=ColorUtils.HEXtoHSL(h);e=ColorUtils.HEXtoHSL(t);o=ColorUtils.HEXtoHSL(i);s=ColorUtils.getHEXDistance(t,i);l=Math.abs(Palettes.lumas[n]-Palettes.lumas[r])/32;if(l>this.lumaDiffThreshold){continue}if(this.excludeNative&&t===i){continue}this.mixed.push({h:d.h,s:d.s,l:d.l,luma:(Palettes.lumas[n]+Palettes.lumas[r])/2,diffH:Math.abs(o.h-e.h),diffS:Math.abs(o.s-e.s),diffLuma:l,distance:s,index1:n.toString(16),index2:r.toString(16),col1:t,col2:i,mix:h,distTo0:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[0])),distTo1:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[1])),distTo2:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[2])),distTo3:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[3])),distTo4:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[4])),distTo5:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[5])),distTo6:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[6])),distTo7:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[7])),distTo8:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[8])),distTo9:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[9])),distToA:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[10])),distToB:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[11])),distToC:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[12])),distToD:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[13])),distToE:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[14])),distToF:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(this.palette[15])),distToRed:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(16711680)),distToGreen:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(65280)),distToBlue:ColorUtils.getHEXDistance(h,ColorUtils.colorToHEX(255))});this.json.push({index1:n,index2:r,mix:h})}}};t.prototype.filter=function(t){if(t==null){t=[]}this.createData();if(t.length>0){this.mixed.sort(SortUtils.dynamicMultiSort(t))}this.createTable();this.fillTable();this.drawColors();this.print(JSON.stringify(this.json))};t.prototype.print=function(t){FileSaver.saveAsTextFile(t)};t.prototype.drawColors=function(){var t,e,i,o,l,s,n;l=8;this.context.fillStyle="#000";this.canvas.width=16*l;this.canvas.height=8*l;HDPI.detectAndSetRatio(this.canvas);this.context.fillRect(0,0,this.canvas.width,this.canvas.height);s=0;n=0;o=this.mixed;for(t=0,e=o.length;t<e;t++){i=o[t];this[this.ditherType](this.canvas,i.col1,i.col2,l,l,s*l,n*l);s++;if(s>16){s=0;n++}}};t.prototype.createTable=function(){var t,e,i,o,l,s,n;this.table=document.getElementById("table");while(this.table.firstChild){this.table.removeChild(this.table.firstChild)}e=["#","mixed","color1","color2","color1","color2","distance","hue","saturation","CBM luma","CBM luma diff","hex value"];i=this.table.createTHead();n=i.insertRow(0);for(o=l=0,s=e.length;l<s;o=++l){t=e[o];n.insertCell(o).innerHTML=t}};t.prototype.noDither=function(t,e,i,o,l,s,n){var r,a;if(s==null){s=0}if(n==null){n=0}a=ColorUtils.mixHEX(e,i);r=t.getContext("2d");r.fillStyle=a;r.fillRect(s,n,o,l)};t.prototype.hiresDither=function(t,e,i,o,l,s,n){var r,a,c,h,d,u,f;if(s==null){s=0}if(n==null){n=0}r=t.getContext("2d");for(u=a=0,h=o;0<=h?a<h:a>h;u=0<=h?++a:--a){for(f=c=0,d=l;0<=d?c<d:c>d;f=0<=d?++c:--c){r.fillStyle=f%2?u%2?e:i:u%2?i:e;r.fillRect(u+s,f+n,1,1)}}};t.prototype.lineDither=function(t,e,i,o,l,s,n){var r,a,c,h;if(s==null){s=0}if(n==null){n=0}r=t.getContext("2d");for(h=a=0,c=l;0<=c?a<c:a>c;h=0<=c?++a:--a){r.fillStyle=h%2?e:i;r.fillRect(s,h+n,o,1)}};t.prototype.multiDither=function(t,e,i,o,l,s,n){var r,a,c,h,d,u,f;if(s==null){s=0}if(n==null){n=0}r=t.getContext("2d");for(u=a=0,h=o;0<=h?a<h:a>h;u=0<=h?++a:--a){for(f=c=0,d=l;0<=d?c<d:c>d;f=0<=d?++c:--c){r.fillStyle=f%2?Math.ceil((u+1)/2)%2?e:i:Math.ceil((u+1)/2)%2?i:e;r.fillRect(u+s,f+n,1,1)}}};t.prototype.fillTable=function(){var t,e,i,o,l,s,n,r,a;i=16;t=this.table.createTBody();r=this.mixed;for(o=l=0,s=r.length;l<s;o=++l){n=r[o];a=t.insertRow(o);a.insertCell(0).innerHTML=o+1;a.insertCell(1).innerHTML="<canvas class='dither' width='"+i+"' height='"+i+"' id='canvas-"+o+"'/>";a.insertCell(2).innerHTML=n.index1;a.insertCell(3).innerHTML=n.index2;a.insertCell(4).innerHTML="<div class='cell' style='background: "+n.col1+"'/>";a.insertCell(5).innerHTML="<div class='cell' style='background: "+n.col2+"'/>";a.insertCell(6).innerHTML=n.distance.toFixed(0);a.insertCell(7).innerHTML=n.h.toFixed(2);a.insertCell(8).innerHTML=n.s.toFixed(2);a.insertCell(9).innerHTML=n.luma.toFixed(2);a.insertCell(10).innerHTML=n.diffLuma.toFixed(2);a.insertCell(11).innerHTML=n.mix;e=document.getElementById("canvas-"+o);HDPI.detectAndSetRatio(e);this[this.ditherType](e,n.col1,n.col2,i,i)}};return t}();main=new Main;